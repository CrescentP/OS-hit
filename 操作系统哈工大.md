# 操作系统

## L1.什么是操作系统

没有操作系统

![image-20210816154000299](C:\Users\Crescent_P\AppData\Roaming\Typora\typora-user-images\image-20210816154000299.png)

CPU发出指令,将内存300位置的数据送到显存中,然后显示`hello`

有操作系统

![image-20210816154111118](C:\Users\Crescent_P\AppData\Roaming\Typora\typora-user-images\image-20210816154111118.png)

```c++
printf("hello");
```

**操作系统:是计算机硬件和应用之间的一层软件**

![image-20210816154226498](C:\Users\Crescent_P\AppData\Roaming\Typora\typora-user-images\image-20210816154226498.png)

**`Learn OS concepts by coding them`**

## L2.开始揭开钢琴的盒子

<img src="操作系统哈工大.assets/image-20210816155717811.png" alt="image-20210816155717811" style="zoom:50%;" />

这个黑色背后发生了什么?

1. 打开电源，计算机开始工作了

2. 计算机怎么工作的？-->**图灵机**-->**通用图灵机**--->计算机

   <img src="操作系统哈工大.assets/image-20210816155926869.png" alt="image-20210816155926869" style="zoom: 33%;" />

**只会做加法**

![image-20210816160157899](操作系统哈工大.assets/image-20210816160157899.png)

![image-20210816160302805](操作系统哈工大.assets/image-20210816160302805.png)

**取值执行**

3. 打开电源，计算机执行的第一句指令是什么？

   ![image-20210816160719686](操作系统哈工大.assets/image-20210816160719686.png)

   0磁道0扇区就是引导扇区,512个Byte

   ![image-20210816160855497](操作系统哈工大.assets/image-20210816160855497.png)

4. 引导扇区(汇编代码) **bootsect.h**

   ![image-20210816162735496](操作系统哈工大.assets/image-20210816162735496.png)

   ![image-20210816163210414](操作系统哈工大.assets/image-20210816163210414.png)

   ![image-20210816163617652](操作系统哈工大.assets/image-20210816163617652.png)

   ![image-20210816164017653](操作系统哈工大.assets/image-20210816164017653.png)

以上是将代码从磁盘读入.

## L3.操作系统启动

![image-20210816171926554](操作系统哈工大.assets/image-20210816171926554.png)

![image-20210816172539259](操作系统哈工大.assets/image-20210816172539259.png)

 ![image-20210816173034729](操作系统哈工大.assets/image-20210816173034729.png)

![image-20210816174808510](操作系统哈工大.assets/image-20210816174808510.png)

**setup.s完成的事情：**

1. 读了硬件参数，为建立操作系统打下基础
2. 将System的代码挪到0地址处，核心代码一直存在这。
3. 开启了保护模式
4. 跳转到0地址处执行System代码

![image-20210816180437600](操作系统哈工大.assets/image-20210816180437600.png)

![image-20210816180556780](操作系统哈工大.assets/image-20210816180556780.png)

![image-20210816180648722](操作系统哈工大.assets/image-20210816180648722.png)

从head.s 跳转到 main.c (从汇编到C)

![image-20210816181413919](操作系统哈工大.assets/image-20210816181413919.png)

![image-20210816181548539](操作系统哈工大.assets/image-20210816181548539.png)

men_init 内存初始化 

![image-20210816181947640](操作系统哈工大.assets/image-20210816181947640.png)

## L4.操作系统接口

![image-20210816191454986](操作系统哈工大.assets/image-20210816191454986.png)

什么是操作系统接口：连接上层用户和操作系统软件

![image-20210816191727480](操作系统哈工大.assets/image-20210816191727480.png)

![image-20210816192101507](操作系统哈工大.assets/image-20210816192101507.png)



![image-20210816192502741](操作系统哈工大.assets/image-20210816192502741.png)

**操作系统接口：系统调用**

![image-20210816192723601](操作系统哈工大.assets/image-20210816192723601.png)

 ![image-20210816192956454](操作系统哈工大.assets/image-20210816192956454.png)

## L5.系统调用的实现

**为什么不能直接访问？**

![image-20210817110241291](操作系统哈工大.assets/image-20210817110241291.png)

DPL:目标内存段的特权级

CPL:当前内存段的特权级

数字越大等级越低，数字越小等级越高

**怎么做到的不能直接访问？**

![image-20210817111534484](操作系统哈工大.assets/image-20210817111534484.png)

**不直接访问，那怎么办？**

中断是进入内核的唯一方法

![image-20210817111902236](操作系统哈工大.assets/image-20210817111902236.png)

![image-20210817112640876](操作系统哈工大.assets/image-20210817112640876.png)





![image-20210817113851260](操作系统哈工大.assets/image-20210817113851260.png)



![image-20210817115537090](操作系统哈工大.assets/image-20210817115537090.png)

![image-20210817124102260](操作系统哈工大.assets/image-20210817124102260.png)

![image-20210817124244473](操作系统哈工大.assets/image-20210817124244473.png)

![image-20210817124352424](操作系统哈工大.assets/image-20210817124352424.png)

## L6.操作系统历史

![image-20210817125319024](操作系统哈工大.assets/image-20210817125319024.png)

![image-20210817125838000](操作系统哈工大.assets/image-20210817125838000.png)

 ![image-20210817130120052](操作系统哈工大.assets/image-20210817130120052.png)

![image-20210817130257449](操作系统哈工大.assets/image-20210817130257449.png)

![image-20210817130530450](操作系统哈工大.assets/image-20210817130530450.png)

![image-20210817130653643](操作系统哈工大.assets/image-20210817130653643.png)



![image-20210817130813176](操作系统哈工大.assets/image-20210817130813176.png)

![image-20210817130924172](操作系统哈工大.assets/image-20210817130924172.png)

![image-20210817131047784](操作系统哈工大.assets/image-20210817131047784.png)



![image-20210817131400473](操作系统哈工大.assets/image-20210817131400473.png)



## L7.我们的学习任务

![image-20210817132128544](操作系统哈工大.assets/image-20210817132128544.png)

![image-20210817132248187](操作系统哈工大.assets/image-20210817132248187.png)

## L8.CPU管理的直观想法

多进程怎么引出来的？

**操作系统的核心就是管理计算机硬件，CPU是计算机最主要的硬件，首先就是要管理CPU，就是在管理CPU的时候才引出了多进程图像。**

![image-20210817160212119](操作系统哈工大.assets/image-20210817160212119.png)

**怎么管理CPU：设置好PC的初值就行了**

![image-20210817161329104](操作系统哈工大.assets/image-20210817161329104.png)

**如果CPU停下来等IO，那么CPU的利用率将会大大降低，此时CPU应该去做别的事情，等IO传输完毕之后，再回来继续这段程序。**

![image-20210817161841905](操作系统哈工大.assets/image-20210817161841905.png)

**多个程序在内存中：多道程序**

![image-20210817162103653](操作系统哈工大.assets/image-20210817162103653.png)

**一个CPU上交替的执行多个程序：`并发`**

![image-20210817162355300](操作系统哈工大.assets/image-20210817162355300.png)

切换PC，指向不同代码段

![image-20210817162650555](操作系统哈工大.assets/image-20210817162650555.png)

**运行中的程序就是进程**

![image-20210817162933521](操作系统哈工大.assets/image-20210817162933521.png)

## L9.多进程图像

![image-20210817163835468](操作系统哈工大.assets/image-20210817163835468.png)

![image-20210817164146294](操作系统哈工大.assets/image-20210817164146294.png)

**看一下自己计算机的进程：任务管理器**

**用户使用计算机就是启动了一系列的进程，OS管理计算机就是管理一系列进程**

![image-20210817164254201](操作系统哈工大.assets/image-20210817164254201.png)



**多个进程如何组织？多个进程的所对应的PCB分别放在不同的地方**

![image-20210817164954763](操作系统哈工大.assets/image-20210817164954763.png)



**进程通过状态来分类**

**操作系统通过使进程的状态发生变化从而推进进程**

![image-20210817165314968](操作系统哈工大.assets/image-20210817165314968.png)

![image-20210817165751020](操作系统哈工大.assets/image-20210817165751020.png)



![image-20210817170203287](操作系统哈工大.assets/image-20210817170203287.png)

![image-20210817170432015](操作系统哈工大.assets/image-20210817170432015.png)

![image-20210817170609724](操作系统哈工大.assets/image-20210817170609724.png)



![image-20210817171100084](操作系统哈工大.assets/image-20210817171100084.png)

![image-20210817171128398](操作系统哈工大.assets/image-20210817171128398.png) 

![image-20210817171319276](操作系统哈工大.assets/image-20210817171319276.png)



## L10.用户级线程

![image-20210817184544276](操作系统哈工大.assets/image-20210817184544276.png)

**线程的切换：是指令之间的切换，资源没有切换**

![image-20210817185153995](操作系统哈工大.assets/image-20210817185153995.png)

![image-20210817185308298](操作系统哈工大.assets/image-20210817185308298.png)



![image-20210817185442425](操作系统哈工大.assets/image-20210817185442425.png) 

![image-20210817190115685](操作系统哈工大.assets/image-20210817190115685.png)

![image-20210817193513538](操作系统哈工大.assets/image-20210817193513538.png)



![image-20210817195310344](操作系统哈工大.assets/image-20210817195310344.png)

![image-20210817195345787](操作系统哈工大.assets/image-20210817195345787.png)

![image-20210817195616986](操作系统哈工大.assets/image-20210817195616986.png)

**核心级线程并发性更好一些**

![image-20210817195738954](操作系统哈工大.assets/image-20210817195738954.png)

## L11.内核级线程































 

















